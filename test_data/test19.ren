use std.assert

struct InnerStruct
{
    x: f32,
    y: f64,
}

implement InnerStruct
{
    function sum() -> f64
    {
        return this.x as f64 + this.y
    }
}

struct OuterStruct
{
    a: i32,
    b: i64,
}

implement OuterStruct
{
    function new() -> InnerStruct
    {
        return InnerStruct { 1.0, 2.0 }
    }
}

function main() -> i32
{
    var outer = OuterStruct { 1, 2 }
    var inner_y = outer.new().y

    var a = outer.new()
    var b = a.y
    a.y = 3.0
    outer.new().y = 5.0
    printf("a.y: %f, b: %f", a.y, b)
    assert(a.y == 3.0 and b == 2.0)
    
    var inner = OuterStruct { 1, 2 }.new()
    var expected_sum = 3.0
    assert_equals_f64(expected_sum, inner.sum(), 0.001)
    printf("\nsum: %f", inner.sum())
    
    return 0
}